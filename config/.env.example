# AegisGate 可调参数（复制为 .env 后编辑，重启容器生效）
# 变量名见 README 配置章节，前缀 AEGIS_

# 日志与运行
AEGIS_LOG_LEVEL=info
# DEBUG 下是否打印完整请求正文（默认 false：只打 method/path/route/headers + body_size）
AEGIS_LOG_FULL_REQUEST_BODY=false
AEGIS_ENV=prod

# 安全档位与网关
AEGIS_SECURITY_LEVEL=medium
# 命中强制命令规则后是否进入高风险确认拦截（不依赖阈值）
AEGIS_STRICT_COMMAND_BLOCK_ENABLED=false
AEGIS_GATEWAY_KEY=agent
AEGIS_DEFAULT_POLICY=default

# 上游与限流
AEGIS_UPSTREAM_TIMEOUT_SECONDS=60
AEGIS_UPSTREAM_MAX_CONNECTIONS=100
AEGIS_UPSTREAM_MAX_KEEPALIVE_CONNECTIONS=20
AEGIS_MAX_REQUEST_BODY_BYTES=2000000
AEGIS_MAX_MESSAGES_COUNT=100
AEGIS_MAX_CONTENT_LENGTH_PER_MESSAGE=50000
AEGIS_MAX_PENDING_PAYLOAD_BYTES=100000
AEGIS_MAX_RESPONSE_LENGTH=500000

# 确认与 pending
AEGIS_CONFIRMATION_TTL_SECONDS=300
AEGIS_PENDING_DATA_TTL_SECONDS=86400

# v2 代理（HTTP/HTTPS 通用转发）
AEGIS_ENABLE_V2_PROXY=true
AEGIS_V2_ENABLE_REQUEST_REDACTION=true
AEGIS_V2_ENABLE_RESPONSE_COMMAND_FILTER=true
# true: 启用最小误拦模式（仅协议层高危 HTTP 报文特征）
AEGIS_V2_RESPONSE_FILTER_OBVIOUS_ONLY=true
# 逗号分隔；支持 example.com / .example.com / *.example.com
AEGIS_V2_RESPONSE_FILTER_BYPASS_HOSTS=
AEGIS_V2_RESPONSE_FILTER_MAX_CHARS=200000

# 语义模块（默认关闭）
AEGIS_ENABLE_SEMANTIC_MODULE=false
AEGIS_SEMANTIC_SERVICE_URL=
AEGIS_SEMANTIC_GRAY_LOW=0.25
AEGIS_SEMANTIC_GRAY_HIGH=0.75
AEGIS_SEMANTIC_TIMEOUT_MS=150
AEGIS_SEMANTIC_CACHE_TTL_SECONDS=300
AEGIS_SEMANTIC_CIRCUIT_FAILURE_THRESHOLD=3
AEGIS_SEMANTIC_CIRCUIT_OPEN_SECONDS=30

# 功能开关（true/false）
# AEGIS_ENABLE_REDACTION=true
# AEGIS_ENABLE_RESTORATION=true
# AEGIS_ENABLE_INJECTION_DETECTOR=true
# AEGIS_ENABLE_PRIVILEGE_GUARD=true
# AEGIS_ENABLE_ANOMALY_DETECTOR=true
# AEGIS_ENABLE_REQUEST_SANITIZER=true
# AEGIS_ENABLE_OUTPUT_SANITIZER=true
# AEGIS_ENABLE_POST_RESTORE_GUARD=true
# AEGIS_ENABLE_UNTRUSTED_CONTENT_GUARD=true
